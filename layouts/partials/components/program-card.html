{{ $program := . }}
{{/* Check if input is a Hugo Page or a Map */}}
{{ $isPage := false }}
{{ if (reflect.IsMap $program) }}
{{ $isPage = false }}
{{ else if (eq (printf "%T" $program) "*hugolib.pageState") }}
{{ $isPage = true }}
{{ end }}

{{/* Extract parameters based on type */}}
{{ $badgeColor := "" }}
{{ $badge := "" }}
{{ $iconPath := "" }}
{{ $title := "" }}
{{ $description := "" }}
{{ $link := "" }}

{{ if $isPage }}
{{ $badgeColor = $program.Params.badge_color | default "green" }}
{{ $badge = $program.Params.badge | default "Event" }}
{{ $iconPath = $program.Params.icon_path }}
{{ $title = $program.Title }}
{{ $description = $program.Description }}
{{ $link = $program.RelPermalink }}
{{ else }}
{{ $badgeColor = $program.badge_color }}
{{ $badge = $program.badge }}
{{ $iconPath = $program.icon_path }}
{{ $title = $program.title }}
{{ $description = $program.description }}
{{ $link = $program.link }}
{{ end }}

{{ $isGreen := eq $badgeColor "green" }}
{{ $gradientUrl := cond $isGreen "url(#gradient-green)" "url(#gradient-purple)" }}
{{ $hoverBorderClass := cond $isGreen "bg-gradient-green-hover" "bg-gradient-purple-hover" }}
{{ $iconBgClass := cond $isGreen "bg-gradient-to-br from-green-500/20 to-emerald-600/20" "bg-gradient-to-br from-purple-500/20 to-violet-700/20" }}
{{ $iconBorderClass := cond $isGreen "border-green-500/20" "border-purple-500/20" }}
{{ $textColor := cond $isGreen "text-green-400" "text-purple-400" }}
{{ $badgeBgClass := cond $isGreen "bg-green-500/10" "bg-purple-500/10" }}
{{ $badgeBorderClass := cond $isGreen "border-green-500/20" "border-purple-500/20" }}
{{ $hoverTextColor := cond $isGreen "hover:text-green-300" "hover:text-purple-300" }}

<div class="relative group h-full">
    {{/* Subtle glow border - Invisible by default, appears on hover */}}
    <div class="absolute -inset-px rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300 {{ $hoverBorderClass }}"></div>

    <div class="relative rounded-2xl p-6 h-full flex flex-col border border-transparent group-hover:border-neutral-800 transition-all duration-300 group-hover:bg-[#0d1117]/80 bg-transparent">
        {{/* Icon + Badge Row */}}
        <div class="flex items-center justify-between mb-5">
            <div class="w-12 h-12 rounded-xl flex items-center justify-center border {{ $iconBgClass }} {{ $iconBorderClass }}">
                <svg class="w-6 h-6 {{ $textColor }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="{{ $iconPath }}" />
                </svg>
            </div>
            <span class="px-3 py-1 text-xs font-medium {{ $textColor }} rounded-full border {{ $badgeBgClass }} {{ $badgeBorderClass }}">
                {{ $badge }}
            </span>
        </div>

        {{/* Title */}}
        <h3 class="text-xl font-semibold text-white mb-2">{{ $title }}</h3>

        {{/* Description */}}
        <p class="text-neutral-400 text-sm leading-relaxed flex-grow mb-6">
            {{ $description }}
        </p>

        {{/* CTA */}}
        <a href="{{ $link }}"
            class="inline-flex items-center gap-2 text-sm font-medium {{ $textColor }} {{ $hoverTextColor }} transition-colors group/link">
            Learn More
            <svg class="w-4 h-4 transition-transform group-hover/link:translate-x-1" fill="none" stroke="currentColor"
                viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
        </a>
    </div>
</div>